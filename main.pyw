# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file '.\main.ui'
#
# Created by: PyQt5 UI code generator 5.15.9
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5.QtWidgets import QApplication, QMainWindow, QPushButton, QLabel, QMessageBox, QSlider
from PyQt5.QtGui import QPixmap
from PyQt5.QtCore import Qt, QPoint, QPropertyAnimation, QRect, QEasingCurve, QResource
from PyQt5 import QtCore, QtGui, QtWidgets
import pygame

import os
import shutil
import requests
import subprocess
import json
from pygame import mixer
import tempfile

class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(800, 400)
        MainWindow.setWindowFlags(Qt.FramelessWindowHint)
        
        app_icon = QtGui.QIcon()
        app_icon.addFile(':/Assets/Assets/logo.png', QtCore.QSize(48, 48))
        app.setWindowIcon(app_icon)
        
        
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")  
        self.BG = QtWidgets.QLabel(self.centralwidget)
        self.BG.setGeometry(QtCore.QRect(0, 0, 800, 400))
        self.BG.setStyleSheet("background-image: url(:/Assets/Assets/bg.png);")
        self.BG.setObjectName("BG")
        self.BG.mousePressEvent = self.mousePressEvent
        self.BG.mouseMoveEvent = self.mouseMoveEvent
        self.BG.mouseReleaseEvent = self.mouseReleaseEvent
        self.progressBar = QtWidgets.QProgressBar(self.centralwidget)
        self.progressBar.setGeometry(QtCore.QRect(10, 370, 781, 20))
        self.progressBar.setAutoFillBackground(False)
        self.progressBar.setProperty("value", 100)
        self.progressBar.setAlignment(QtCore.Qt.AlignCenter)
        self.progressBar.setTextVisible(False)
        self.progressBar.setOrientation(QtCore.Qt.Horizontal)
        self.progressBar.setInvertedAppearance(False)
        self.progressBar.setObjectName("progressBar")
        
        self.Logs = QLabel(self.centralwidget)
        self.Logs.setObjectName(u"Logs")
        self.Logs.setGeometry(QRect(36, 371, 721, 21))
        self.Logs.setStyleSheet(u"font: 75 12pt \"Microsoft New Tai Lue\";")
        self.Logs.setAlignment(Qt.AlignCenter)
        
        
        self.Btn_Play = QtWidgets.QPushButton(self.centralwidget)
        self.Btn_Play.setGeometry(QtCore.QRect(630, 310, 161, 53))
        self.Btn_Play.setStyleSheet("image: url(:/Assets/Assets/btn.png);")
        self.Btn_Play.setObjectName("Btn_Play")
        #self.Btn_Play.clicked.connect(self.OnPlay)
        
        self.setup_button_animations()
        
        self.Logo = QtWidgets.QLabel(self.centralwidget)
        self.Logo.setGeometry(QtCore.QRect(0, 60, 801, 231))
        self.Logo.setStyleSheet("image: url(:/Assets/Assets/--OctoCraft--.png);")
        self.Logo.setText("")
        self.Logo.setObjectName("Logo")
        self.Logo.mousePressEvent = self.mousePressEvent
        self.Logo.mouseMoveEvent = self.mouseMoveEvent
        self.Logo.mouseReleaseEvent = self.mouseReleaseEvent
        
        self.exit = QtWidgets.QLabel(self.centralwidget)
        self.exit.setObjectName(u"exit")
        self.exit.setGeometry(QtCore.QRect(750, 10, 51, 31))
        self.exit.setStyleSheet(u"image: url(:/Assets/Assets/croix.png);")
        self.exit.mousePressEvent = self.exit_clicked
        MainWindow.setCentralWidget(self.centralwidget)

        self.retranslateUi(MainWindow)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)
        
        appdata_path = os.getenv('APPDATA')
        file_path = os.path.join(appdata_path, 'KSH-Soft', 'OctoCraft', 'Installed')
        if not os.path.exists(file_path):
            self.Btn_Play.setText("INSTALLER")
        
        file_path = os.path.join(appdata_path, 'KSH-Soft', 'OctoCraft')
        # if os.path.exists(file_path) and os.path.isdir(file_path):
        #     shutil.rmtree(file_path)
        try:
            os.mkdir(file_path)
        except:
            pass
        os.chdir(file_path)
        
        # Initialiser le slider de volume
        self.volume_slider = QtWidgets.QSlider(self.centralwidget)
        # self.volume_slider = QSlider(Qt.Horizontal)
        self.volume_slider.setOrientation(Qt.Horizontal)
        self.volume_slider.setGeometry(630, 290, 161, 16)  # Position et taille du slider
        self.volume_slider.setRange(0, 100)  # Plage de valeurs du slider
        self.volume_slider.setValue(75)  # Valeur initiale du slider
        self.volume_slider.valueChanged.connect(self.change_volume)
        
        self.play_music()
        self.updateModList()
        
        # self.update_progress(0, 1)

    
    def play_music(file_path):
        # Initialiser le lecteur audio
        mixer.init()

        # Extraire le fichier MP3 à partir des ressources
        mp3_resource = QResource(":/Assets/Assets/Angello.mp3")
        mp3_data = mp3_resource.data()

        # Créer un fichier temporaire pour le MP3
        temp_file = tempfile.NamedTemporaryFile(delete=False)
        temp_file.write(mp3_data)
        temp_file.close()

        # Charger le MP3 depuis le fichier temporaire
        mixer.music.load(temp_file.name)
        mixer.music.set_volume(0.75)  # Ajuster le volume (0.0 à 1.0)
        # mixer.music.set_volume(0.01)  # Ajuster le volume (0.0 à 1.0)
        mixer.music.play(-1)  # -1 pour la lecture en boucle
        
    def change_volume(self, value):
        # Convertir la valeur du slider (0-100) en valeur de volume (0.0-1.0)
        volume = value / 100.0
        mixer.music.set_volume(volume)
            
    def exit_clicked(self, event):
        # Function to execute when the exit QLabel is clicked
        QApplication.instance().quit()
        mixer.music.stop()            
    def exit_clicked1(self):
        # Function to execute when the exit QLabel is clicked
        QApplication.instance().quit()
        mixer.music.stop()

    def retranslateUi(self, MainWindow):
        MainWindow.setWindowTitle("MainWindow")
        self.progressBar.setFormat("%p%")
        self.Logs.setText("Bienvenue sur OctoCraft.")
        self.Btn_Play.setText("JOUER")
     
           
    def lire_premiere_ligne(self, nom_fichier):
        try:
            with open(nom_fichier, 'r') as fichier:
                premiere_ligne = fichier.readline().strip()
                return premiere_ligne
        except FileNotFoundError:
            print(f"Le fichier {nom_fichier} n'a pas été trouvé.")
            return None
    
    def lire_lignes_suivantes(self, nom_fichier):
        try:
            with open(nom_fichier, 'r') as fichier:
                # Ignore la première ligne
                fichier.readline()
                lignes_suivantes = [ligne.strip() for ligne in fichier.readlines()]
                return lignes_suivantes
        except FileNotFoundError:
            print(f"Le fichier {nom_fichier} n'a pas été trouvé.")
            return None    
        
    def update_progress(self, nb, count):
        # Update the nb value and calculate the progress
        nb = nb
        count = count
        # self.nb += 10  # You can adjust this value based on your requirements
        progress_value = int((nb / count) * 100)

        # Set the value to the progress bar
        self.progressBar.setValue(progress_value)
        
    def OnPlay(self):
        print('You clicked PLAY')
        appdata_path = os.getenv('APPDATA')
        file_path = os.path.join(appdata_path, 'KSH-Soft', 'OctoCraft', 'Installed')
        if os.path.exists(file_path):
            print("The file exists!")
            content = self.Btn_Play.text() 
            if content == "JOUER":
                print("launch")
                file_path = os.path.join(appdata_path, '.minecraft', 'servers.dat')
                try:
                    with open(file_path, 'r') as file:
                        content = file.read()
                        if 'By Nativ\'s - KSH-Soft' not in content:
                            print("Erreur: La suite de mots 'By Nativ's - KSH-Soft' n'est pas présente dans le fichier.")
                            box = QMessageBox()
                            box.setIcon(QMessageBox.Information)
                            box.setWindowTitle(' Add to Fav ')
                            box.setText('Pour rejoindre le monde de OctoCraft\nVous devrez mettre le server en favoris\n\n\nNom: "§kLOL§r §e- §3Octo§2Craft§r §e-§r §kLOL§r      By Nativ\'s - KSH-Soft :"  \n\nIP : "77.193.9.215"')
                            box.setStandardButtons(QMessageBox.Ok)
                            box.exec_()
                except FileNotFoundError:
                    print("Erreur: Le fichier servers.dat n'a pas été trouvé.")
                    box = QMessageBox()
                    box.setIcon(QMessageBox.Information)
                    box.setWindowTitle(' Add to Fav ')
                    box.setText('Le fichier servers.dat n\'a pas été trouvé.')
                    box.setStandardButtons(QMessageBox.Ok)
                    box.exec_()
                except Exception as e:
                    print(f"Erreur inattendue: {e}")
                    box = QMessageBox()
                    box.setIcon(QMessageBox.Information)
                    box.setWindowTitle(' Add to Fav ')
                    box.setText(f'Erreur inattendue: {e}')
                    box.setStandardButtons(QMessageBox.Ok)
                    box.exec_()
                os.startfile('C:\\Program Files (x86)\\Minecraft\\Minecraft Launcher\\MinecraftLauncher.exe')
                self.exit_clicked1()
            else:
                with open(r'OctoCraft-ModVersion.txt', 'r') as fp:
                    for count, line in enumerate(fp):
                        pass
                print('Total Lines', count )
                
                nom_fichier_version = 'OctoCraft-ModVersion.txt'
                lignes_suivantes = self.lire_lignes_suivantes(nom_fichier_version)
                nb = 0
                self.Btn_Play.setDisabled(1)
                self.update_progress(nb, count)
                if lignes_suivantes is not None:
                    for ligne in lignes_suivantes:
                        print(ligne)
                        path = os.path.join(appdata_path, '.minecraft', 'mods', ligne)
                        if not os.path.exists(path):
                            url = 'http://kashi.world.free.fr//OctoCraft//' + ligne
                            r = requests.get(url, allow_redirects=True)
                            open(ligne, 'wb').write(r.content)
                            shutil.move(ligne, path)
                        nb = nb + 1
                        self.update_progress(nb, count)
                
                self.Btn_Play.setDisabled(0)            
                            
                nom_fichier_version = 'version.txt'
                nom_fichier_version_Octo = 'OctoCraft-ModVersion.txt'
                premiere_ligne_o = self.lire_premiere_ligne(nom_fichier_version_Octo)
                v_o = premiere_ligne_o
                
                file_path = os.path.join(appdata_path, 'KSH-Soft', 'OctoCraft', 'version.txt')
                fichier = open(file_path, "w")
                fichier.write(v_o)
                fichier.close()
                self.Btn_Play.setText("JOUER")
                
                box = QMessageBox()
                box.setIcon(QMessageBox.Information)
                box.setWindowTitle(' Mise à jour ')
                box.setText('Votre Launcher est a jour\nVous pouvez lancer Minecraft et rejoindre le monde d\'OctoCraft\n\nCliquez Maintenant sur JOUER')
                box.setStandardButtons(QMessageBox.Ok)
                box.exec_()
                
                
                            
        #Install        
        else:
            print("The file does not exist.")
            box = QMessageBox()
            box.setIcon(QMessageBox.Question)
            box.setWindowTitle(' OctoCraft n\'est pas installé ')
            box.setText(' Voulez-vous installer tout les prérequis.\nIls sont necéssaire pour rentrer dans le monde de OctoCraft ? ')
            box.setStandardButtons(QMessageBox.Yes|QMessageBox.No)
            buttonY = box.button(QMessageBox.Yes)
            buttonY.setText(' Oui. ')
            buttonN = box.button(QMessageBox.No)
            buttonN.setText(' Naan ')
            box.exec_()
            if box.clickedButton() == buttonN:
                print('You clicked No!')
                box = QMessageBox()
                box.setIcon(QMessageBox.Critical)
                box.setWindowTitle(' Bah Nique ')
                box.setText('    Prout    ')
                box.setStandardButtons(QMessageBox.Ok)
                box.exec_()
                # QApplication.instance().quit()
            elif box.clickedButton() == buttonY:
                print('You clicked Yes!')
                # Directory 
                cwd = os.getcwd()
                print(cwd)
                
                file_path = os.path.join(appdata_path, 'KSH-Soft', 'OctoCraft', 'fabric-installer-0.11.2.jar')
                # if not os.path.exists(file_path):
                #     url = 'http://kashi.world.free.fr/Octocraft/fabric-installer-0.11.2.jar'
                #     r = requests.get(url, allow_redirects=True)
                #     open('fabric-installer-0.11.2.jar', 'wb').write(r.content)
                def telecharger_fichier(url, destination):
                    response = requests.get(url)
                    
                    if response.status_code == 200:
                        with open(destination, 'wb') as fichier:
                            fichier.write(response.content)
                        print(f'Le fichier a été téléchargé avec succès dans {destination}')
                    else:
                        print(f'Erreur {response.status_code}: Impossible de télécharger le fichier')
                
                # Exemple d'utilisation
                url_du_fichier = 'http://kashi.world.free.fr//OctoCraft//fabric-installer-0.11.2.jar'
                destination_locale = file_path
                
                telecharger_fichier(url_du_fichier, destination_locale)

                
                file_path = os.path.join(appdata_path, 'KSH-Soft', 'OctoCraft', 'OctoCraft-ModVersion.txt')
                if not os.path.exists(file_path):
                    url = 'http://kashi.world.free.fr//OctoCraft//OctoCraft-ModVersion.txt'
                    r = requests.get(url, allow_redirects=True)
                    open('OctoCraft-ModVersion.txt', 'wb').write(r.content)
                
                file_path = os.path.join(appdata_path, 'KSH-Soft', 'OctoCraft', 'install-fabric.bat')
                if not os.path.exists(file_path):
                    fichier = open("install-fabric.bat", "a")
                    fichier.write("cd %appdata%\\KSH-Soft\\OctoCraft")
                    fichier.write("\njava -jar fabric-installer-0.11.2.jar client -mcversion 1.20.2 -dir %appdata%\\.minecraft")
                    fichier.close()
                
                os.system("start /wait cmd /c install-fabric.bat")
                
                file_path = os.path.join(appdata_path, '.minecraft', 'versions', 'fabric-loader-0.15.2-1.20.2')
                file_pathnew = os.path.join(appdata_path, '.minecraft', 'versions', 'OctoCraft')
                os.rename(file_path, file_pathnew)
                
                file_path = os.path.join(appdata_path, '.minecraft', 'versions', 'OctoCraft', 'fabric-loader-0.15.2-1.20.2.jar')
                file_pathnew = os.path.join(appdata_path, '.minecraft', 'versions', 'OctoCraft', 'OctoCraft.jar')
                os.rename(file_path, file_pathnew)
                
                file_path = os.path.join(appdata_path, '.minecraft', 'versions', 'OctoCraft', 'fabric-loader-0.15.2-1.20.2.json')
                file_pathnew = os.path.join(appdata_path, '.minecraft', 'versions', 'OctoCraft', 'OctoCraft.json')
                os.rename(file_path, file_pathnew)
                                
                # Charger le contenu du fichier JSON
                with open(file_pathnew, 'r') as file:
                    data = json.load(file)
                # Modifier la valeur de la clé "id"
                data['id'] = 'OctoCraft'
                # Enregistrer le fichier JSON mis à jour
                with open(file_pathnew, 'w') as file:
                    json.dump(data, file, indent=4)
                    
                    
                file_path = os.path.join(appdata_path, '.minecraft', 'launcher_profiles.json')    
                with open(file_path, 'r') as file:
                    data = json.load(file)
                # Modifier le nom de la section 'Forge' par 'OctoCraft'
                data['profiles']['OctoCraft'] = data['profiles'].pop('fabric-loader-1.20.2')
                data['profiles']['OctoCraft']['lastVersionId'] = 'OctoCraft'
                data['profiles']['OctoCraft']['name'] = 'OctoCraft'
                data['profiles']['OctoCraft']['icon'] = 'data:image/png;base64,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'
                # Enregistrer les modifications dans le fichier JSON
                with open(file_path, 'w') as file:
                    json.dump(data, file, indent=2)
                
                file_path = os.path.join(appdata_path, 'KSH-Soft', 'OctoCraft', 'Installed')
                fichier = open(file_path, "a")
                fichier.write("Bon jeu")
                fichier.close()
                file_path = os.path.join(appdata_path, 'KSH-Soft', 'OctoCraft', 'version.txt')
                fichier = open(file_path, "a")
                fichier.write("0.0.0")
                fichier.close()
                self.Btn_Play.setText("Update MODS")
                # curl http://kashi.world.free.fr//Octocraft//OctoCraft-ModVersion.txt
                # fabric-installer-0.11.2.jar
                
               
                self.updateMod()
    
    
    def updateMod(self):
        self.updateModList()
                
        # Exemple d'utilisation
        nom_fichier_version = 'version.txt'
        premiere_ligne = self.lire_premiere_ligne(nom_fichier_version)
        if premiere_ligne is not None:
            print(f'Première ligne du fichier {nom_fichier_version}: {premiere_ligne}')
        
        # Lecture des lignes suivantes
        lignes_suivantes = self.lire_lignes_suivantes(nom_fichier_version)
        if lignes_suivantes is not None:
            print(f"Lignes suivantes du fichier {nom_fichier_version}:")
            for ligne in lignes_suivantes:
                print(ligne)
        
        
    def updateModList(self):
        url = 'http://kashi.world.free.fr//OctoCraft//OctoCraft-ModVersion.txt'
        r = requests.get(url, allow_redirects=True)
        open('OctoCraft-ModVersion.txt', 'wb').write(r.content)
        
        nom_fichier_version = 'version.txt'
        nom_fichier_octo_version = 'OctoCraft-ModVersion.txt'
        # Lecture de la première ligne de version.txt
        premiere_ligne_version = self.lire_premiere_ligne(nom_fichier_version)
        
        # Lecture de la première ligne d'Octo-version.txt
        premiere_ligne_octo_version = self.lire_premiere_ligne(nom_fichier_octo_version)
        
        # Comparaison des premières lignes
        if premiere_ligne_version is not None and premiere_ligne_octo_version is not None:
            if premiere_ligne_version != premiere_ligne_octo_version:
                print("Version not valid: La première ligne de Octo-version.txt diffère de celle de version.txt.")
                self.Btn_Play.setText("Update MODS")
            else:
                print("Version valid: La première ligne de Octo-version.txt est identique à celle de version.txt.")
                self.Btn_Play.setText("JOUER")

    def mousePressEvent(self, event):
        if event.button() == Qt.LeftButton:
            self.drag_position = event.globalPos() - MainWindow.pos()
            event.accept()

    def mouseMoveEvent(self, event):
        if hasattr(self, 'drag_position') and event.buttons() == Qt.LeftButton:
            MainWindow.move(event.globalPos() - self.drag_position)
            event.accept()

    def mouseReleaseEvent(self, event):
        if hasattr(self, 'drag_position'):
            del self.drag_position

    def setup_button_animations(self):
        # Hover animation
        self.hover_animation = QPropertyAnimation(self.Btn_Play, b"opacity")
        self.hover_animation.setDuration(200)
        self.hover_animation.setStartValue(1.0)
        self.hover_animation.setEndValue(0.7)

        # Click animation
        self.click_animation = QPropertyAnimation(self.Btn_Play, b"geometry")
        self.click_animation.setDuration(100)
        self.click_animation.setEasingCurve(QEasingCurve.OutQuad)

        self.click_animation.setKeyValueAt(0, self.Btn_Play.geometry())
        self.click_animation.setKeyValueAt(0.5, QRect(self.Btn_Play.x(), self.Btn_Play.y() + 3, self.Btn_Play.width(), self.Btn_Play.height()))
        self.click_animation.setKeyValueAt(1, self.Btn_Play.geometry())

        # Connect animations to button events
        self.Btn_Play.enterEvent = self.start_hover_animation
        self.Btn_Play.leaveEvent = self.start_reverse_hover_animation
        self.Btn_Play.mousePressEvent = self.start_click_animation

    def start_hover_animation(self, event):
        self.hover_animation.start()

    def start_reverse_hover_animation(self, event):
        self.hover_animation.setDirection(QPropertyAnimation.Backward)
        self.hover_animation.start()

    def start_click_animation(self, event):
        self.click_animation.start()
        self.OnPlay()

        
import ressources

if __name__ == "__main__":
    import sys
    app = QApplication(sys.argv)
    app.setStyle("Fusion")
    MainWindow = QMainWindow()
    ui = Ui_MainWindow()
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec_())
    mixer.music.stop()